<section class="space-y-4">
  <!-- Toolbar -->
  <header class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
    <h1 class="text-xl font-semibold text-ink">Servers</h1>

    <div class="flex flex-wrap gap-2 items-center">
      <select
        class="rounded-lg border border-ui bg-surface-elev text-ink px-3 py-2"
        (change)="onStatusChange($event)">
        <option value="all">All status</option>
        <option value="running">Running</option>
        <option value="stopped">Stopped</option>
      </select>

      <button class="px-4 py-2 rounded-lg text-white bg-primary hover:bg-primary-700 transition-colors">
        Add Server
      </button>
    </div>
  </header>

  <!-- SKELETON (Table with card rows) -->
  @if (loading()) {
    <div class="hidden md:block space-y-4">
      <!-- Skeleton Header -->
      <div class="bg-[color-mix(in_oklab,_var(--surface)_92%,_black)] rounded-lg border border-ui/30 px-4 py-3">
        <div class="grid grid-cols-[2fr_1fr_0.5fr_0.5fr_0.5fr_1fr_1fr_1fr] gap-4">
          <div class="skeleton h-4 w-12"></div>
          <div class="skeleton h-4 w-10"></div>
          <div class="skeleton h-4 w-8"></div>
          <div class="skeleton h-4 w-8"></div>
          <div class="skeleton h-4 w-8"></div>
          <div class="skeleton h-4 w-16"></div>
          <div class="skeleton h-4 w-12"></div>
          <div class="skeleton h-4 w-12"></div>
        </div>
      </div>

      <!-- Skeleton Rows -->
      <div class="space-y-3">
        @for (_ of skeletonRows; track $index) {
          <div class="server-card">
            <div class="grid grid-cols-[2fr_1fr_0.5fr_0.5fr_0.5fr_1fr_1fr_1fr] gap-4 items-center">
              <div class="skeleton h-5 w-3/4"></div>
              <div class="skeleton h-5 w-1/2"></div>
              <div class="skeleton h-5 w-full"></div>
              <div class="skeleton h-5 w-full"></div>
              <div class="skeleton h-5 w-full"></div>
              <div class="skeleton h-5 w-2/3"></div>
              <div class="skeleton h-5 w-1/2"></div>
              <div class="skeleton h-5 w-1/2"></div>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Mobile Skeleton -->
    <div class="md:hidden space-y-3">
      @for (_ of skeletonRows; track $index) {
        <div class="server-card">
          <div class="flex items-center justify-between mb-2">
            <div class="skeleton h-5 w-32"></div>
            <div class="skeleton h-3 w-3 rounded-full"></div>
          </div>
          <div class="skeleton h-4 w-full"></div>
          <div class="skeleton h-3 w-3/4 mt-1"></div>
        </div>
      }
    </div>
  }

  <!-- TABLE WITH CARD ROWS (md+) -->
  @if (!loading()) {
    <div class="hidden md:block space-y-4">
      <!-- Table Header -->
      <div class="px-4 py-3">
        <div class="grid grid-cols-[2fr_1fr_0.5fr_0.5fr_0.5fr_1fr_1fr_1fr] gap-4 text-sm text-soft font-bold">
          <div>Name</div>
          <div>Type</div>
          <div class="text-xs">vCPUs</div>
          <div class="text-xs">RAM</div>
          <div class="text-xs">SSD</div>
          <div>Location</div>
          <div>Status</div>
          <div class="text-right">Price</div>
        </div>
      </div>

      <!-- Table Rows as Cards -->
      <div class="space-y-3">
        @for (s of view(); track trackRow($index, s)) {
          <div class="server-card cursor-pointer">
            <div class="grid grid-cols-[2fr_1fr_0.5fr_0.5fr_0.5fr_1fr_1fr_1fr] gap-4 items-center text-sm">
              <div class="font-medium text-primary">{{ s.name }}</div>
              <div class="text-soft">{{ s.type }}</div>
              <div class="text-soft text-xs">{{ getCpuCount(s) }}</div>
              <div class="text-soft text-xs">{{ getRamSize(s) }}</div>
              <div class="text-soft text-xs">{{ getDiskSize(s) }}</div>
              <div class="text-soft">
                @if (hasCountryData(s)) {
                  <span class="inline-flex items-center gap-2">
                    <span class="text-base">{{ getCountryFlag(s) }}</span>
                    <span>{{ getCleanCityName(s) }}</span>
                  </span>
                } @else {
                  <span>{{ getCleanCityName(s) }}</span>
                }
              </div>
              <div>
                <span class="inline-flex items-center gap-2">
                  <span class="status-dot" [ngClass]="s.status"></span>
                  <span class="capitalize">{{ s.status }}</span>
                </span>
              </div>
              <div class="text-right text-soft">
                €{{ s.priceEur.toFixed(2) }}/mo
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  }

  <!-- MOBILE CARDS (sm) -->
  @if (!loading()) {
    <div class="md:hidden space-y-3">
      @for (s of view(); track trackRow($index, s)) {
        <div class="server-card">
          <div class="flex items-center justify-between">
            <div class="name">{{ s.name }}</div>
            <div class="status-dot" [ngClass]="s.status"></div>
          </div>
          <div class="meta">
            @if (hasCountryData(s)) {
              {{ s.type }} • {{ getCountryFlag(s) }} {{ getCleanCityName(s) }} • €{{ s.priceEur.toFixed(2) }}/mo
            } @else {
              {{ s.type }} • {{ getCleanCityName(s) }} • €{{ s.priceEur.toFixed(2) }}/mo
            }
          </div>
          <div class="hardware text-xs text-soft mt-1">
            {{ getHardwareSpecs(s) }}
          </div>
        </div>
      }
    </div>
  }
</section>
